{% extends 'appomatic_siteinfo/models/BaseModel/page.html' %}
{% load endless %}

{% block content_title_content %}
  {{block.super}}
  {{obj.name}}
{% endblock %}

{% block properties %}
  <tr><th>Aliases</th><td>
    {% for alias in obj.aliases.all %}
      {{alias.name}},
    {% endfor %}
  </td></tr>
{% endblock %}

{% block content_outer %}
  <iframe class="map" src="{% url 'appomatic_mapserver.views.application' application='appomatic_siteinfo.models.SiteInfoMap' %}?operator={{obj.id}}"></iframe>
  <div class="objinfo">
    {{block.super}}
  </div>
{% endblock %}


{% block content %}
  {{block.super}}

  {% if obj.supplies.all %}
    <h2>Supplied these chemicals</h2>
    {% paginate 10 obj.supplies.all as paginated_chemicals %}
    <div class="excerpts">
      {% for chemical in paginated_chemicals %}
        {{ chemical.render_as.excerpt|safe }}
      {% endfor %}
    </div>
    <div class="pagination">{% show_pages %}</div>
  {% endif %}

  {% if obj.supplied_event.all %}
    <h2>Supplied chemicals to these events</h2>
    {% paginate 10 obj.supplied_event.all as paginated_events %}
    <div class="excerpts">
      {% for event in paginated_events %}
        {{ event.event.render_as.excerpt|safe }}
      {% endfor %}
    </div>
    <div class="pagination">{% show_pages %}</div>
  {% endif %}

  {% if obj.sites.all %}
    <h2>Operates these sites</h2>
    {% paginate 10 obj.sites.all as paginated_sites %}
    <table class="table table-striped table-bordered table-condesed">
      <thead><tr><th>Name</th><th>Latitude</th><th>Longitude</th></tr></thead>
      <tbody>
        {% for site in paginated_sites %}
          <tr>
            <td><a href="{{site.get_absolute_url}}">{{site.name}}</td>
            <td><a href="{{site.get_absolute_url}}">{{site.latitude}}</td>
            <td><a href="{{site.get_absolute_url}}">{{site.longitude}}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <div class="pagination">{% show_pages %}</div>
  {% endif %}

  {% if obj.wells.all %}
    <h2>Operates these wells</h2>
    {% paginate 10 obj.wells.all as paginated_wells %}
    <table class="table table-striped table-bordered table-condesed">
      <thead><tr><th>API</th><th>Latitude</th><th>Longitude</th></tr></thead>
      <tbody>
        {% for well in paginated_wells %}
          <tr>
            <td><a href="{{well.get_absolute_url}}">{{well.api}}</td>
            <td><a href="{{well.get_absolute_url}}">{{well.latitude}}</td>
            <td><a href="{{well.get_absolute_url}}">{{well.longitude}}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <div class="pagination">{% show_pages %}</div>
  {% endif %}


  {% if obj.events.all %}
    <h2>Responsible for these events</h2>
    {% paginate 10 obj.events.all as paginated_events %}
    <div class="excerpts">
      {% for event in paginated_events %}
        {{ event.render_as.excerpt|safe }}
      {% endfor %}
    </div>
    <div class="pagination">{% show_pages %}</div>
  {% endif %}

{% endblock %}
